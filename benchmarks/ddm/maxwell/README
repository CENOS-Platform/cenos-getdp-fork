Domain decomposition solver for HF Maxwell's equations
------------------------------------------------------

The core DDM code is contained in the 'main' directory.  The two
files: 'Maxwell.pro' and 'DDM_sweep.pro' respectively address the
classical and DDM formulations. The user should simply include
'../main/Maxwell.pro' (using the getdp command: Include
"pathTo/myFile.pro") at the end of the main '.pro' file of the
problem. The main_original folder contains an outdated version of the
files that do not allow sweeping and is kept as a reference.

Several regions are defined in these files that must be properly
referenced (even if they are empty) by the user and match the physical
regions of the mesh. This is usually done in a separate file to be
included in the main problem file. These regions are:

 * Omega~{i}: the interior of the i-th subdomain;
 * GammaInf~{i}: the portion of its boundary with Sommerfeld condition;
 * GammaScat~{i}: the portion of its boundary with Dirichlet condition;
 * GammaN~{i}: the portion of its boundary with Neumann condition;
 * GammaC: the portion of the boundary where the tangential component
   of the field is forced to 0 (via a constraint in the function
   space). Useful for conducting parts when *total field* computations
   are performed.
 * Sigma~{i}~{j}: the artificial interfaces (j = 0,1 for left,right);
 * Sigma~{i}: the union of Sigma~{i}~{0} and Sigma~{i}~{1}.

Indices should range from 0 to N_DOM-1. Similar regions (with the
exception of Sigma) should be defined, without indices, for the full
domain. It is important that the surface meshes are generated in such
a way that the normals are pointing in the outward direction for
boundaries where a condition involving a normal derivative is
imposed. TODO: rule for mesh names !!

Different transmission conditions are available in the DDM
formulation. One of them must be selected among Silver-MÃ¼ller (SM),
OSRC or JFLEE by setting the corresponding flag in the configuration
file to 1 and all others to 0. Two version of the OSRC operators are
availbale in the Maxwell code; to use the second version, select the
OSRC2 flag *and* the OSRC flag. Each of them has parameters; default
values are specified in the file 'tcDefaults.pro' that can be included
at the beginning of the problem file for simplicity.

The PRECOND_SWEEP flag must be set/unset to enable/disable the double
sweep preconditioner, that can significantly improve the convergence
rate in the case of layered (1d-like) decompositions when many
subdomains are involved, with an increased iteration cost.

Some additional functions must be specified by the user. They are:

 * k[]: the wavenumber (a constant in homogeneous media);
 * kInf[]: the wavenumber to be used in the Sommerfeld condition;
 * kDtN[]: the wavenumber to be used in the transmission conditions;
 * einc[]: the Dirichlet data to be imposed on GammaScat;

With the exception of some particular problems (namely waveguide
problems), they can simply be set to the wavenumber of the problem.

The DDM solver is called by the following command line:

  getdp myProblem.pro -sol DDM -v 0 -bin -ksp_monitor

(The -v 0 and -ksp_monitor options make the output more readable, -bin
speeds up the writing of the solution.) A full solution can be
computed by calling:

  getdp myProblem.pro -sol -pos -bin

and selecting the 'Maxwell_Lagrange' formulations.

The solutions (scattered fields) are written as 'e_vol_%d.pos' on each
subdomain or 'e_lag_vol.pos' for the full solution. Total field
solutions are also saved, as 'e_vol_tot%d.pos' on each subdomain or
'e_lag_vol_tot.pos'.